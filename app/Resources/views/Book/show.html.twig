{% extends "layout.html.twig" %}

{% block title %}
	<i>{{ book.title }}</i>
	{% if book.author is not empty %}
		от {{ book.author }}
	{% endif %}
{% endblock %}

{% block content %}

	{% import '_bookMacros.html.twig' as _ %}

	<h1>{{ block('title') }}</h1>

	<ol class="breadcrumb">
		<li><a href="{{ path('books') }}">Книги</a></li>
		<li class="active">№ {{ book.id }}</li>
	</ol>

	<div class="row" itemscope itemtype="http://schema.org/Book">
		<div class="col-xs-5 col-md-4" data-featherlight-gallery data-featherlight-filter="a">
			{% if book.cover %}
				<a href="/thumb/{{ _.thumb(book.cover, 800) }}" class="thumbnail" style="width: 310px; max-width: 100%">
					<img src="/thumb/{{ _.thumb(book.cover, 300) }}" width="300">
				</a>
			{% else %}
				<img src="/thumb/nocover.300.png" width="300" class="thumbnail">
			{% endif %}
			{% if book.backCover %}
				<a href="/thumb/{{ _.thumb(book.backCover, 800) }}" class="thumbnail" style="width: 310px; max-width: 100%">
					<img src="/thumb/{{ _.thumb(book.backCover, 300) }}" width="300">
				</a>
			{% else %}
				<img src="/thumb/nobackcover.300.png" width="300" class="thumbnail">
			{% endif %}
		</div>
		<div class="col-xs-7 col-md-8">
			{% if book.isIncomplete %}
				<p class="text-danger">
					Записът е непълен.
					{% if book.reasonWhyIncomplete is not empty %}
						({{ book.reasonWhyIncomplete }})
					{% endif %}
				</p>
			{% endif %}
			<dl class="dl-horizontal">
				{% for field in fields %}
					{{ _.printField(book, field, searchableFields) }}
				{% endfor %}
				{% if book.hasRevisions %}
					<dt>Промени от</dt>
					<dd>
						<ul class="list-inline">
						{% for revisionEditor in book.revisionEditors %}
							<li>
								{{ revisionEditor }}
								<a href="{{ path('fos_message_thread_new', { username: revisionEditor }) }}" title="Изпращане на лично съобщение"><span class="fa fa-comment-o"></span></a>
							</li>
						{% endfor %}
						</ul>
					</dd>
				{% endif %}
				<dt>...</dt>
				<dd>
					<a href="{{ path('easyadmin') }}?action=edit&entity=Book&id={{ book.id }}" title="Редактиране на записа" class="btn btn-default"><span class="fa fa-pencil"></span></a>
				</dd>
			</dl>
		</div>
	</div>

	<section data-featherlight-gallery data-featherlight-filter="a">
	<h2>Сканирани страници</h2>
	<div class="row">
		{% for i in range(1, 15) %}
			{% set scan = attribute(book, "scan"~i) %}
			{% if scan is not empty %}
				<div class="col-xs-6 col-md-3">
					<a href="/thumb/{{ _.thumb(scan, 800) }}" class="thumbnail">
						<img src="/thumb/{{ _.thumb(scan, 300) }}" width="300" style="max-height: 370px">
					</a>
				</div>
			{% endif %}
		{% endfor %}
	</div>
		{% if book.nbScans == 0 %}
			<p class="text-danger">Липсват сканирани страници.</p>
		{% endif %}
	</section>

{% endblock %}
